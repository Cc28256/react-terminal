"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),n=require("prop-types"),t=require("react-device-detect");function o(e){var n=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var o=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,o.get?o:{enumerable:!0,get:function(){return e[t]}})}})),n.default=e,Object.freeze(n)}var r=o(e),a=function(){return a=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},a.apply(this,arguments)};function l(e,n,t,o){return new(t||(t=Promise))((function(r,a){function l(e){try{c(o.next(e))}catch(e){a(e)}}function i(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,i)}c((o=o.apply(e,n||[])).next())}))}function i(e,n){var t,o,r,a,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(c){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(l=0)),l;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(r=l.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){l.label=i[1];break}if(6===i[0]&&l.label<r[1]){l.label=r[1],r=i;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(i);break}r[2]&&l.ops.pop(),l.trys.pop();continue}i=n.call(e,l)}catch(e){i=[6,e],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}!function(e,n){void 0===n&&(n={});var t=n.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===t&&o.firstChild?o.insertBefore(r,o.firstChild):o.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}('@import url("https://fonts.googleapis.com/css?family=Source+Code+Pro&display=swap");\n#index_terminalContainer__4seT6 {\n  --control-default-bg-color: #ccc;\n  --control-close-bg-color: #fc5b57;\n  --control-minimize-bg-color: #e5bf3c;\n  --control-maximize-bg-color: #57c038;\n}\n\n.index_controls__sXDjs {\n  text-align: left;\n  height: 26px;\n  position: relative;\n  top: 4px;\n  margin-left: 4px;\n}\n.index_controls__sXDjs .index_consoleCtrl__DI2H1 {\n  display: inline-block;\n  width: 13px;\n  height: 13px;\n  margin: 0 3px;\n  border-radius: 50%;\n  background: var(--control-default-bg-color);\n}\n.index_controls__sXDjs .index_close__XGN9U {\n  background: var(--control-close-bg-color);\n}\n.index_controls__sXDjs .index_minimize__pZYTU {\n  background: var(--control-minimize-bg-color);\n}\n.index_controls__sXDjs .index_maximize__szRK7 {\n  background: var(--control-maximize-bg-color);\n}\n\n.index_editor__JoDSg {\n  text-align: left;\n  height: 100%;\n  padding: 10px 15px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  outline: none;\n  font-family: "Source Code Pro", monospace;\n  font-size: 18px;\n  line-height: 22px;\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n}\n.index_editor__JoDSg .index_mobileInput__WloSq {\n  position: absolute;\n  top: -2000px;\n  left: -2000px;\n}\n.index_editor__JoDSg .index_lineText__j6qNj {\n  display: inline;\n  position: relative;\n  top: -1px;\n  margin-left: 8px;\n}\n.index_editor__JoDSg .index_preWhiteSpace__7KwuG {\n  white-space: pre-wrap;\n}\n.index_editor__JoDSg .index_caret__VS4iV {\n  position: relative;\n  -webkit-animation: index_blink__FJp0- 0.75s ease-in-out infinite;\n  -moz-animation: index_blink__FJp0- 0.75s ease-in-out infinite;\n  -o-animation: index_blink__FJp0- 0.75s ease-in-out infinite;\n  -ms-animation: index_blink__FJp0- 0.75s ease-in-out infinite;\n  animation: index_blink__FJp0- 0.75s ease-in-out infinite;\n}\n.index_editor__JoDSg .index_caret__VS4iV .index_caretAfter__6aXPx {\n  content: "";\n  position: absolute;\n  top: 2px;\n  width: 10px;\n  height: 22px;\n  z-index: 10;\n}\n@-moz-keyframes index_blink__FJp0- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@-webkit-keyframes index_blink__FJp0- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@-o-keyframes index_blink__FJp0- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n@keyframes index_blink__FJp0- {\n  0% {\n    opacity: 0;\n    -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";\n    filter: alpha(opacity=0);\n  }\n  100% {\n    opacity: 1;\n    -ms-filter: none;\n    filter: none;\n  }\n}\n.index_editor__JoDSg a {\n  color: #1a87b5;\n}\n\n.index_editorWithTopBar__L6XKw {\n  height: calc(100% - 46px);\n}\n\n.index_curvedTop__LX9XS {\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n}\n\n#index_terminalContainer__4seT6 {\n  height: 100%;\n}\n\n.index_terminal__teubZ {\n  height: 100%;\n  width: 100%;\n  margin: auto;\n  border-radius: 5px;\n}');var c={terminalContainer:"index_terminalContainer__4seT6",controls:"index_controls__sXDjs",consoleCtrl:"index_consoleCtrl__DI2H1",close:"index_close__XGN9U",minimize:"index_minimize__pZYTU",maximize:"index_maximize__szRK7",editor:"index_editor__JoDSg",mobileInput:"index_mobileInput__WloSq",lineText:"index_lineText__j6qNj",preWhiteSpace:"index_preWhiteSpace__7KwuG",caret:"index_caret__VS4iV",blink:"index_blink__FJp0-",caretAfter:"index_caretAfter__6aXPx",editorWithTopBar:"index_editorWithTopBar__L6XKw",curvedTop:"index_curvedTop__LX9XS",terminal:"index_terminal__teubZ"},s=r.createContext(null),u=function(e){var n=e.children;return r.createElement(s.Provider,{value:c},n)},m={dark:{themeBGColor:"#022833",themeToolbarColor:"#131519",themeColor:"#839496",themePromptColor:"#a917a8"},light:{themeBGColor:"#fdf6e4",themeToolbarColor:"#d8d8d8",themeColor:"#333333",themePromptColor:"#a917a8"},dracula:{themeBGColor:"#272B36",themeToolbarColor:"#DBDBDB",themeColor:"#FFFEFC",themePromptColor:"#a917a8"},"material-dark":{themeBGColor:"#151515",themeToolbarColor:"#424242",themeColor:"#fff",themePromptColor:"#42A5F5"},"material-light":{themeBGColor:"#fafafa",themeToolbarColor:"#424242",themeColor:"#151515",themePromptColor:"#42A5F5"},"material-ocean":{themeBGColor:"#263238",themeToolbarColor:"#37474F",themeColor:"#fff",themePromptColor:"#C3D82C"},matrix:{themeBGColor:"#0D0208",themeToolbarColor:"#0D0208",themeColor:"#00FF41",themePromptColor:"#008F11"}},p=r.createContext(null),d=function(e){var n=e.children,t=a(a({},m),n.props.themes||{}),o=t[n.props.theme]||t.light;return r.createElement(p.Provider,{value:o},n)},f=function(e,n,o){var a=function(r){e.current&&!e.current.contains(r.target)?o(!1):t.isMobile?o(!n):o(!0)};r.useEffect((function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}}))};function _(e){var n=r.useContext(s),t=e.controlButtonLabels,o=e.showControlButtons?t.map((function(e){return r.createElement("div",{key:e,className:"".concat(n.consoleCtrl," ").concat(n[e])})})):null;return r.createElement("div",{className:n.controls},o)}var h=r.createContext(null),x=function(){function e(){}return e.splitStringAtIndex=function(e,n){return e?[e.substring(0,n),e.substring(n)]:["",""]},e}(),g=function(e,n,o,a,c,u,m,d){var f=r.useContext(s),_=r.useContext(p),g=r.useContext(h).appendCommandToHistory,b=r.useRef(null),C=r.useState(""),v=C[0],y=C[1],E=r.useState(!1),w=E[0],T=E[1],S=r.useState(0),k=S[0],B=S[1],D=r.useState(""),F=D[0],P=D[1],N=r.useState(""),A=N[0],j=N[1];r.useEffect((function(){t.isMobile}),[n]),r.useEffect((function(){w&&g(v)}),[w]),r.useEffect((function(){null!==d.current&&null!==b.current&&(d.current.onclick=function(){b.current.focus()})}),[]);var z=t.isMobile&&u?r.createElement("div",{className:f.mobileInput},r.createElement("input",{type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false",value:v,onChange:function(e){return y(e.target.value)},ref:b,"data-testid":"editor-input"})):null,I=w?r.createElement(r.Fragment,null,z,r.createElement("div",{className:f.lineText},n&&e?r.createElement("span",{className:f.caret},r.createElement("span",{className:f.caretAfter,style:{background:_.themeColor}})):null)):r.createElement(r.Fragment,null,z,r.createElement("span",{style:{color:_.themePromptColor}},o),r.createElement("div",{className:f.lineText},r.createElement("span",{className:f.preWhiteSpace},F),n&&e?r.createElement("span",{className:f.caret},r.createElement("span",{className:f.caretAfter,style:{background:_.themeColor}})):null,r.createElement("span",{className:f.preWhiteSpace},A)));return function(e,n,t,o,a,l,i,c,s){var u=r.useContext(h),m=u.getPreviousCommand,p=u.getNextCommand,d=function(r){if(e&&s){r.preventDefault();var i=r.key;if("Enter"!==i){var c=null;if("Backspace"===i){var u=x.splitStringAtIndex(n,a),d=u[0],f=u[1];c=d.slice(0,-1)+f,n&&0!==n.length&&l(a-1)}else if("ArrowUp"===i)(c=m())&&l(c.length);else if("ArrowDown"===i)c=p(),l(c?c.length:0);else if("ArrowLeft"===i)a>0&&l(a-1),c=n;else if("ArrowRight"===i)a<n.length&&l(a+1),c=n;else if((r.metaKey||r.ctrlKey)&&"v"===i.toLowerCase())navigator.clipboard.readText().then((function(e){var o=x.splitStringAtIndex(n||"",a),r=o[0],i=o[1];c=r+e+i,l(a+e.length),t(c)}));else if((r.metaKey||r.ctrlKey)&&"c"===i.toLowerCase()){var _=window.getSelection().toString();navigator.clipboard.writeText(_).then((function(){t(c=n)}))}else if(i&&1===i.length){var h=x.splitStringAtIndex(n,a);d=h[0],f=h[1],c=d+i+f,l(a+1)}else c=n;t(c),o(!1)}else o(!0)}};r.useEffect((function(){return document.addEventListener("keydown",d),function(){document.removeEventListener("keydown",d)}})),r.useEffect((function(){var e=x.splitStringAtIndex(n,a),t=e[0],o=e[1];i(t),c(o)}),[n,a])}(n,v,y,T,k,B,P,j,u),function(e,n,t,o,a,c,u,m,d,f,_){var x=r.useContext(h),g=x.bufferedContent,b=x.setBufferedContent,C=r.useContext(s),v=r.useContext(p);r.useEffect((function(){var s;e&&(s=o,l(void 0,void 0,void 0,(function(){var e,l,p,h,x,y,E,w,T,S,k,B,D,F,P;return i(this,(function(i){switch(i.label){case 0:return e=s.trim().split(" "),l=e[0],p=e.slice(1),h="","clear"===l?(b(""),a(""),n(!1),c(0),u(""),m(""),[2]):(x=r.createElement(r.Fragment,null,g,r.createElement("span",{style:{color:v.themePromptColor}},t),r.createElement("span",{className:"".concat(C.lineText," ").concat(C.preWhiteSpace)},o),r.createElement("br",null)),b(x),a(""),c(0),u(""),m(""),s?(y=p.join(" "),l&&d[l]?"function"!=typeof(E=d[l])?[3,2]:[4,E(y)]:[3,4]):[3,11]);case 1:return h=i.sent(),[3,3];case 2:h=E,i.label=3;case 3:return[3,11];case 4:if("function"!=typeof _)return[3,8];w=l,T=y,S=y,i.label=5;case 5:return[4,_(w,T)];case 6:return h=i.sent(),k=h.trim().split(" "),B=k[0],D=k.slice(1),S+=D,console.log(S),"no"!==B?(h=S,[3,7]):(T="next_get_data",F=r.createElement(r.Fragment,null,g,r.createElement("span",{style:{color:v.themePromptColor}},t),r.createElement("span",{className:"".concat(C.lineText," ").concat(C.preWhiteSpace)},o),S?r.createElement("span",null,r.createElement("br",null),r.createElement("pre",{className:"".concat(C.editor)},S)):null,r.createElement("br",null)),b(F),[3,5]);case 7:return[3,11];case 8:return"function"!=typeof f?[3,10]:[4,f(l,y)];case 9:return h=i.sent(),[3,11];case 10:h=f,i.label=11;case 11:return P=r.createElement(r.Fragment,null,g,r.createElement("span",{style:{color:v.themePromptColor}},t),r.createElement("span",{className:"".concat(C.lineText," ").concat(C.preWhiteSpace)},o),h?r.createElement("span",null,r.createElement("br",null),r.createElement("pre",{className:"".concat(C.editor)},h)):null,r.createElement("br",null)),b(P),n(!1),[2]}}))})))}),[e])}(w,T,o,v,y,B,P,j,a,c,m),I},b=function(e,n){r.useEffect((function(){n.current&&(n.current.scrollTop=n.current.scrollHeight)}),[e])};function C(e){var n=r.useRef(null),t=r.useContext(s),o=r.useContext(p),a=r.useContext(h).bufferedContent;b(a,n);var l=e.enableInput,i=e.caret,c=e.consoleFocused,u=e.prompt,m=e.commands,d=e.welcomeMessage,f=e.errorMessage,_=e.showControlBar,x=e.defaultHandler,C=g(i,c,u,m,f,l,x,n);return r.createElement("div",{id:"terminalEditor",ref:n,className:"".concat(t.editor," ").concat(_?null:t.curvedTop," ").concat(_?t.editorWithTopBar:null),style:{background:o.themeBGColor}},d,a,C)}function v(e){var n=r.useRef(null),o=r.useState(!t.isMobile),a=o[0],l=o[1],i=r.useContext(s),c=r.useContext(p);f(n,a,l);var u=e.caret,m=e.theme,d=e.showControlBar,h=e.showControlButtons,x=e.controlButtonLabels,g=e.prompt,b=e.commands,v=e.welcomeMessage,y=e.errorMessage,E=e.enableInput,w=e.defaultHandler,T=d?r.createElement(_,{consoleFocused:a,showControlButtons:h,controlButtonLabels:x}):null,S=r.createElement(C,{caret:u,consoleFocused:a,prompt:g,commands:b,welcomeMessage:v,errorMessage:y,enableInput:E,showControlBar:d,defaultHandler:w});return r.createElement("div",{ref:n,id:i.terminalContainer,className:i["theme--".concat(m)],"data-testid":"terminal"},r.createElement("div",{className:"".concat(i.terminal),style:{background:c.themeToolbarColor,color:c.themeColor}},T,S))}function y(e){var n=e.children;return r.createElement(u,null,r.createElement(d,null,n))}function E(e){return r.createElement(y,null,r.createElement(v,a({},e)))}v.propTypes={enableInput:n.bool,caret:n.bool,theme:n.string,showControlBar:n.bool,showControlButtons:n.bool,controlButtonLabels:n.arrayOf(n.string),prompt:n.string,commands:n.objectOf(n.oneOfType([n.string,n.func,n.node])),welcomeMessage:n.oneOfType([n.string,n.func,n.node]),errorMessage:n.oneOfType([n.string,n.func,n.node]),defaultHandler:n.func},v.defaultProps={enableInput:!0,caret:!0,theme:"light",showControlBar:!0,showControlButtons:!0,controlButtonLabels:["close","minimize","maximize"],prompt:">>>",commands:{},welcomeMessage:"",errorMessage:"not found!",defaultHandler:null};var w=function(e){var n=e.children,t=r.useState(""),o=t[0],a=t[1],l=r.useState([]),i=l[0],c=l[1],s=r.useState(null),u=s[0],m=s[1];r.useEffect((function(){m(i.length)}),[i]);return r.createElement(h.Provider,{value:{bufferedContent:o,setBufferedContent:a,appendCommandToHistory:function(e){e&&c(i.concat(e))},getPreviousCommand:function(){if(0===u)return 0===i.length?"":i[0];var e=i[u-1];return u>0&&m(u-1),e},getNextCommand:function(){if(u+1<=i.length){var e=i[u+1];return m(u+1),e}return""}}},n)},T={ReactTerminal:E,TerminalContextProvider:w};exports.ReactTerminal=E,exports.TerminalContextProvider=w,exports.default=T;
